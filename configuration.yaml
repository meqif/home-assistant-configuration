homeassistant:
  # Name of the location where Home Assistant is running
  name: Home
  # Location required to calculate the time the sun rises and sets
  latitude: !secret home_latitude
  longitude: !secret home_longitude
  # Impacts weather/sunrise data (altitude above sea level in meters)
  elevation: !secret home_elevation
  # metric for Metric, imperial for Imperial
  unit_system: metric
  # Pick yours from here: http://en.wikipedia.org/wiki/List_of_tz_database_time_zones
  time_zone: Europe/Lisbon
  # Customization file
  customize: !include customize.yaml

# Configure a default setup of Home Assistant (frontend, api, etc)
default_config:

# Show the introduction message on startup.
# introduction:

# Uncomment this if you are using SSL/TLS, running in Docker container, etc.
http:
  base_url: !secret http_base_url
  use_x_forwarded_for: true
  # Trust the Docker container host
  trusted_proxies: !secret http_trusted_proxies

# Discover some devices automatically
discovery:

lovelace:
  mode: yaml

# Sensors
sensor:
  - platform: waze_travel_time
    origin: !secret home_gps_coords
    destination: !secret work_gps_coords
    region: EU
    name: Work commute
  - platform: waze_travel_time
    origin: !secret work_gps_coords
    destination: !secret home_gps_coords
    region: EU
    name: Home commute
  - platform: mqtt_room
    device_id: !secret phone_beacon
    name: 'Room Presence'
    state_topic: 'room_presence'
    timeout: 5
    away_timeout: 10
  - platform: template
    sensors:
      ricardo_presence:
        friendly_name: "Ricardo's Presence"
        value_template: >-
          {% if not is_state('sensor.room_presence', 'not_home') %}
            {{ states('sensor.room_presence') }}
          {% else %}
            {{ states('device_tracker.ricardo_s_google_pixel') }}
          {% endif %}

mqtt:
  broker: !secret mqtt_broker
  client_id: "home-assistant"

device_tracker: !include device_tracker.yaml

person:
  - name: Ricardo
    id: ab9ea2abf06e46eb8ce169784ccdefa2
    user_id: f9054ef8dbf6487dae10d4f703695118
    device_trackers:
      - device_tracker.ricardo_s_google_pixel

# Devices
neato:
  username: !secret neato_username
  password: !secret neato_password

geo_location:
  - platform: geo_json_events
    url: 'http://ipma-data:8080/seismic_activity'
    entity_namespace: ipma_seismic
    radius: 300

input_boolean:
  relaxing:
    name: "Relax scene is on"
    initial: false

switch:
  - platform: template
    switches:
      relax_scene:
        friendly_name: "Relax scene"
        icon_template: 'mdi:headphones'
        value_template: "{{ is_state('input_boolean.relaxing', 'on') }}"
        turn_on:
          - service: input_boolean.turn_on
            data:
              entity_id: input_boolean.relaxing
          - service: scene.turn_on
            data:
              entity_id: scene.relax
        turn_off:
          - service: input_boolean.turn_off
            data:
              entity_id: input_boolean.relaxing
          - service: scene.turn_on
            data:
              entity_id: scene.regular_lights

group: !include groups.yaml
automation: !include automations.yaml
script: !include scripts.yaml
frontend: !include frontend.yaml
scene: !include scene.yaml
